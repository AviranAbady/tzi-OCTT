sequenceDiagram
    participant CS as Charging Station (OCTT)
    participant CSMS as CSMS (System Under Test)

    Note over CS,CSMS: Test Case: TC_K_53_CSMS
    Note over CS,CSMS: Charging with load leveling based on<br/>High Level Communication - Success

    Note over CS,CSMS: Reusable States: Authorized + EVConnectedPreSession

    Note over CS,CSMS: Execute reusable state ISO15118SmartCharging

    CS->>CSMS: 1. NotifyEVChargingNeedsRequest
    Note right of CS: evseId = <Configured evseId><br/>maxScheduleTuples & chargingNeeds

    CSMS-->>CS: 2. NotifyEVChargingNeedsResponse
    Note left of CSMS: status = Accepted or Processing

    CSMS->>CS: 3. SetChargingProfileRequest

    CS-->>CSMS: 4. SetChargingProfileResponse
    Note right of CS: status = Accepted

    CS->>CSMS: 5. NotifyEVChargingScheduleRequest
    Note right of CS: evseId = <Configured evseId><br/>chargingSchedule = <Schedule from step 3>

    CSMS-->>CS: 6. NotifyEVChargingScheduleResponse

    CS->>CSMS: 7. TransactionEventRequest
    Note right of CS: triggerReason = ChargingStateChanged<br/>chargingState = Charging

    CSMS-->>CS: 8. TransactionEventResponse
