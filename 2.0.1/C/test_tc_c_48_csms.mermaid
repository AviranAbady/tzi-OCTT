sequenceDiagram
    participant CS as Charging Station (OCTT)
    participant CSMS as CSMS (System Under Test)

    Note over CS, CSMS: Test Case: TC_C_48_CSMS
    Note over CS, CSMS: Stop Transaction with a Master Pass - With UI - Specific transactions
    Note over CS, CSMS: Use Case: C16 | Requirement: C16_FR_01

    Note over CS, CSMS: Prerequisite: idToken with MasterPass as GroupId is configured
    Note over CS: Initial State: EnergyTransferStarted for all EVSE

    CS->>+CSMS: 1. AuthorizeRequest
    Note right of CS: idToken.idToken: [Configured valid_idtoken_idtoken]<br/>(this idToken has MasterPass as GroupId)<br/>idToken.type: [Configured valid_idtoken_type]

    CSMS-->>-CS: 2. AuthorizeResponse
    Note left of CSMS: idTokenInfo.status: Accepted<br/>idTokenInfo.groupIdToken.idToken: masterPassGroupId

    Note over CS: User selects to stop ONE specific transaction via UI

    CS->>+CSMS: 3. TransactionEventRequest
    Note right of CS: transactionInfo.stoppedReason: MasterPass<br/>idToken.idToken: [Configured masterpass_idtoken_idtoken]<br/>idToken.type: [Configured masterpass_idtoken_type]<br/>eventType: Ended

    CSMS-->>-CS: 4. TransactionEventResponse
    Note left of CSMS: idTokenInfo.status: Accepted<br/>idTokenInfo.groupIdToken.idToken: masterPassGroupId

    Note over CS, CSMS: Result: Selected transaction stopped, cable unlocked

    Note over CS, CSMS: Tool Validations
    Note over CS, CSMS: Step 2: idTokenInfo.status=Accepted, groupIdToken.idToken=masterPassGroupId
    Note over CS, CSMS: Step 4: idTokenInfo.status=Accepted, groupIdToken.idToken=masterPassGroupId
