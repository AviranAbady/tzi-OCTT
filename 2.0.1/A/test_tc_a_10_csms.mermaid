sequenceDiagram
    participant CS as Charging Station (OCTT)
    participant CSMS as CSMS (System Under Test)

    Note over CS,CSMS: Test Case: TC_A_10_CSMS
    Note over CS,CSMS: Update Charging Station Password - Rejected
    Note over CS,CSMS: Prerequisite: CSMS supports security profile 1 and/or 2

    CSMS->>CS: 1. SetVariablesRequest
    Note left of CSMS: setVariableData[1]:<br/>variable.name = "BasicAuthPassword"<br/>component.name = "SecurityCtrlr"<br/>attributeValue = "<NewPassword>"

    CS-->>CSMS: 2. SetVariablesResponse (status: Rejected)

    CS->>CSMS: 3. HTTP Upgrade Request with Authorization Header
    Note right of CS: AUTHORIZATION: Basic<br/>Base64(ChargingStationId:OLD BasicAuthPassword)

    CSMS-->>CS: 4. Validate old credentials and upgrade to WebSocket
    Note over CSMS: CSMS still accepts old password<br/>since password change was rejected

    CS->>CSMS: 5. BootNotificationRequest
    CSMS-->>CS: 6. BootNotificationResponse
    Note over CSMS: Validation: status must be Accepted

    CS->>CSMS: 7. Notify current state of all connectors
    CSMS-->>CS: 8. Response
