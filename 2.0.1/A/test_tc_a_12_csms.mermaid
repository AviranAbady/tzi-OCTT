sequenceDiagram
    participant CS as Charging Station (OCTT)
    participant CSMS as CSMS (System Under Test)

    Note over CS,CSMS: Test Case: TC_A_12_CSMS
    Note over CS,CSMS: Update CS Certificate - Success - V2G Certificate
    Note over CS,CSMS: Prerequisite: CSMS supports ISO 15118

    CSMS->>CS: 1. TriggerMessageRequest
    Note left of CSMS: requestedMessage: SignV2GCertificate<br/>EVSE: <EVSE with seccId>

    CS-->>CSMS: 2. TriggerMessageResponse (status: Accepted)
    Note over CS: Validation: status must be Accepted

    CS->>CSMS: 3. SignCertificateRequest
    Note right of CS: csr: <Generated CSR><br/>certificateType: V2GCertificate

    CSMS-->>CS: 4. SignCertificateResponse (status: Accepted)
    Note over CSMS: Validation: status must be Accepted

    CSMS->>CS: 5. CertificateSignedRequest
    Note left of CSMS: certificateChain: <Certificate generated<br/>from CSR, signed by V2G Root or SubCA>

    CS-->>CSMS: 6. CertificateSignedResponse (status: Accepted)

    Note over CS,CSMS: Note: Steps 1-6 repeated for all returned seccIds
