sequenceDiagram
    participant CS as Charging Station (OCTT)
    participant CSMS as CSMS (System Under Test)

    Note over CS,CSMS: Test Case: TC_B_21_CSMS
    Note over CS,CSMS: Reset CS - With Ongoing Transaction - OnIdle
    Note over CS,CSMS: Reusable State: EnergyTransferStarted

    Note over CSMS: Manual Action: Request CSMS to reboot CS<br/>with status OnIdle

    CSMS->>CS: 1. ResetRequest (type: OnIdle)
    CS-->>CSMS: 2. ResetResponse (status: Scheduled)

    CS->>CSMS: 3. TransactionEventRequest
    Note right of CS: eventType: Updated<br/>triggerReason: StopAuthorized<br/>chargingState: EVConnected

    CSMS-->>CS: 4. TransactionEventResponse

    CS->>CSMS: 5. TransactionEventRequest
    Note right of CS: eventType: Ended<br/>triggerReason: EVCommunicationLost<br/>chargingState: Idle<br/>stoppedReason: EVDisconnected

    CSMS-->>CS: 6. TransactionEventResponse

    Note over CS: CS reboots after transaction ends

    CS->>CSMS: 7. BootNotificationRequest (reason: ScheduledReset)
    CSMS-->>CS: 8. BootNotificationResponse (status: Accepted)

    CS->>CSMS: 9. StatusNotificationRequest + NotifyEventRequest
    CSMS-->>CS: 10. Responses
