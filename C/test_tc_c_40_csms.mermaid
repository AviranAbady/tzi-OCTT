sequenceDiagram
    participant CS as Charging Station (OCTT)
    participant CSMS as CSMS (System Under Test)

    Note over CS, CSMS: Test Case: TC_C_40_CSMS
    Note over CS, CSMS: Authorization by GroupId - Success with Local Authorization List
    Note over CS, CSMS: Use Case: C09 | Requirements: C09_FR_02, C09_FR_03

    Note over CS, CSMS: Prerequisites: Two valid idTokens with same GroupId in Local Authorization List
    Note over CS: Initial State: EVConnectedPreSession

    CS->>CSMS: TransactionEventRequest
    Note right of CS: triggerReason: Authorized<br/>idToken.idToken: valid_idtoken_idtoken (in Local Auth List)<br/>idToken.type: valid_idtoken_type<br/>eventType: Started or Updated

    CSMS-->>CS: TransactionEventResponse
    Note left of CSMS: idTokenInfo.status: Accepted<br/>idTokenInfo.groupIdToken.idToken: configured_groupIdToken

    Note over CS: Execute Reusable State: EnergyTransferStarted

    CS->>CSMS: TransactionEventRequest
    Note right of CS: triggerReason: StopAuthorized<br/>idToken.idToken: valid_idtoken2_idtoken (in Local Auth List, same GroupId)<br/>idToken.type: valid_idtoken2_type<br/>eventType: Updated

    CSMS-->>CS: TransactionEventResponse
    Note left of CSMS: idTokenInfo.status: Accepted<br/>idTokenInfo.groupIdToken.idToken: configured_groupIdToken

    Note over CS: Execute Reusable State: EVConnectedPostSession
    Note over CS: Execute Reusable State: EVDisconnected

    Note over CS, CSMS: Tool Validations
    Note over CS, CSMS: Step 2: idTokenInfo.status=Accepted, groupIdToken.idToken=configured_groupIdToken
    Note over CS, CSMS: Step 6: idTokenInfo.status=Accepted, groupIdToken.idToken=configured_groupIdToken
