sequenceDiagram
    participant CS as Charging Station (OCTT)
    participant CSMS as CSMS (System Under Test)

    Note over CS,CSMS: Test Case: TC_A_06_CSMS
    Note over CS,CSMS: TLS - server-side certificate - TLS version too low
    Note over CS,CSMS: Prerequisite: CSMS supports security profile 2 and/or 3

    CS->>CSMS: 1. Initiate TLS handshake (TLS version < 1.2)
    CSMS--xCS: 2. CSMS rejects connection (TLS version too low)

    Note over CS,CSMS: First connection attempt fails

    CS->>CSMS: 3. Initiate TLS handshake (TLS version >= 1.2)
    CSMS-->>CS: 4. Server Hello with <Configured server certificate>

    Note over CS: 5. OCTT performs:<br/>Send client certificate (SP3 only)<br/>Client Key Exchange<br/>Certificate verify<br/>Change Cipher Spec<br/>Finished

    Note over CSMS: 6. CSMS performs:<br/>Change Cipher Spec<br/>Finished

    Note over CS,CSMS: TLS Handshake Complete

    CS->>CSMS: 7. HTTP Upgrade Request
    Note right of CS: Note: Contains username/password<br/>only when CSMS uses security profile 2

    CSMS-->>CS: 8. Upgrade to (secured) WebSocket connection

    CS->>CSMS: 9. BootNotificationRequest (reason: PowerUp)
    CSMS-->>CS: 10. BootNotificationResponse (status: Accepted)
    Note over CSMS: Validation: status must be Accepted

    CS->>CSMS: 11. StatusNotificationRequest (connectorStatus: Available)
    CSMS-->>CS: Response

    CS->>CSMS: 11. NotifyEventRequest
    Note right of CS: trigger: Delta<br/>actualValue: "Available"<br/>component.name: "Connector"<br/>variable.name: "AvailabilityState"
    CSMS-->>CS: 12. Response
