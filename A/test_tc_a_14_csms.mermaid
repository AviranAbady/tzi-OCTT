sequenceDiagram
    participant CS as Charging Station (OCTT)
    participant CSMS as CSMS (System Under Test)

    Note over CS,CSMS: Test Case: TC_A_14_CSMS
    Note over CS,CSMS: Update CS Certificate - Invalid certificate
    Note over CS,CSMS: Prerequisite: CSMS supports security profile 3

    CSMS->>CS: 1. TriggerMessageRequest
    Note left of CSMS: requestedMessage:<br/>SignChargingStationCertificate

    CS-->>CSMS: 2. TriggerMessageResponse (status: Accepted)
    Note over CS: Validation: status must be Accepted

    CS->>CSMS: 3. SignCertificateRequest
    Note right of CS: csr: <Configured CSR><br/>certificateType: ChargingStationCertificate

    CSMS-->>CS: 4. SignCertificateResponse (status: Accepted)
    Note over CSMS: Validation: status must be Accepted

    CSMS->>CS: 5. CertificateSignedRequest

    CS-->>CSMS: 6. CertificateSignedResponse (status: Rejected)
    Note over CS: Charging Station rejects the new certificate

    CS->>CSMS: 7. SecurityEventNotificationRequest
    Note right of CS: type = InvalidChargingStationCertificate
    CSMS-->>CS: 8. SecurityEventNotificationResponse
